import pandas as pdimport requestsimport timeimport osrawdata = pd.read_excel('年报链接_2022.xlsx', sheet_name=0)def get_data(iloc):    firm = rawdata.at[iloc, '标题'].replace("*", "")  # 去掉*ST的*号，文件命名不含特殊符号    code = str(rawdata.at[iloc, '公司代码'])    if(len(code) < 6):        while(6-len(code)):            code = '0'+code    print(code)    year = rawdata.at[iloc, '年份']    pdf_url = rawdata.at[iloc, '年报链接']    company = rawdata.at[iloc, '公司简称'].replace("*", "")  # 去掉*ST的*号，文件命名不含特殊符号    return firm, code, year, pdf_url, companydef get_filepath(code, company, year):    file_path = 'C://Users\末路歧途\Desktop\LC 爬取\年报PDF版'    file_name = "{}_{}_{}.pdf".format(code, company, year)    file_full_name = os.path.join(file_path, file_name)    return file_full_namedef download_pdf(url, file_full_name):    headers = {'User-Agent':"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60"}    res = requests.get(url, headers=headers)    with open(file_full_name, "wb") as fp:        for chunk in res.iter_content(chunk_size=1024):            if chunk:                fp.write(chunk)for iloc in range(rawdata.shape[0]):    firm, code, year, pdf_url, company = get_data(iloc)    print("开始下载{}，股票代码{}的{}年报".format(company, code, year))    file_full_name = get_filepath(code, company, year)    download_pdf(pdf_url, file_full_name)    time.sleep(1)    print("===========下载完成==========")